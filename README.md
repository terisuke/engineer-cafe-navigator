# Engineer Cafe Navigator

> ç¦å²¡å¸‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚«ãƒ•ã‚§ã®éŸ³å£°AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 

[![Next.js](https://img.shields.io/badge/Next.js-15.3.2-black)](https://nextjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.8.3-blue)](https://www.typescriptlang.org/)
[![Mastra](https://img.shields.io/badge/Mastra-0.10.1-green)](https://mastra.ai/)
[![React](https://img.shields.io/badge/React-19.1.0-61dafb)](https://reactjs.org/)
[![Three.js](https://img.shields.io/badge/Three.js-VRM-orange)](https://threejs.org/)

## ğŸ“– ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Engineer Cafe Navigatorï¼ˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚«ãƒ•ã‚§ãƒŠãƒ“ã‚²ãƒ¼ã‚¿ãƒ¼ï¼‰ã¯ã€ç¦å²¡å¸‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚«ãƒ•ã‚§ã®æ–°è¦é¡§å®¢å¯¾å¿œã‚’è‡ªå‹•åŒ–ã™ã‚‹**å¤šè¨€èªå¯¾å¿œéŸ³å£°AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ **ã§ã™ã€‚Mastraãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã—ã€ã‚¹ã‚¿ãƒƒãƒ•ã®è² æ‹…è»½æ¸›ã¨é¡§å®¢æº€è¶³åº¦å‘ä¸Šã‚’ç›®æŒ‡ã—ã¾ã™ã€‚

### ğŸ†• æœ€æ–°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ (2025/05/30)

#### âœ… å®Ÿè£…å®Œäº†
- **Service Accountèªè¨¼ã¸ã®ç§»è¡Œ** - APIã‚­ãƒ¼ä¸è¦ã§ã‚ˆã‚Šå®‰å…¨ãªèªè¨¼æ–¹å¼ã«
- **Supabaseãƒ¡ãƒ¢ãƒªã‚¢ãƒ€ãƒ—ã‚¿çµ±åˆ** - æ°¸ç¶šçš„ãªä¼šè©±å±¥æ­´ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **ãƒãƒ«ãƒã‚¿ãƒ¼ãƒ³ä¼šè©±å¯¾å¿œ** - æ–‡è„ˆã‚’ä¿æŒã—ãŸè‡ªç„¶ãªå¯¾è©±ãŒå¯èƒ½ã«
- **Google Cloud Voice Service** - TTS/STTå®Œå…¨çµ±åˆã€Service Accountèªè¨¼
- **æ„Ÿæƒ…èªè­˜ã‚·ã‚¹ãƒ†ãƒ ** - ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰æ„Ÿæƒ…ã‚’æ¤œå‡ºã—ã€VRMè¡¨æƒ…åˆ¶å¾¡ã«é€£æº
- **VRMè¡¨æƒ…ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³** - ä¼šè©±å†…å®¹ã«å¿œã˜ãŸè‡ªå‹•è¡¨æƒ…å¤‰åŒ–
- **ä¼šè©±æ–‡è„ˆä¿æŒ** - æ„Ÿæƒ…ã‚’å«ã‚€è©³ç´°ãªä¼šè©±å±¥æ­´ã®æ°¸ç¶šåŒ–

### ğŸ¯ ä¸»ãªç›®çš„

- **æ–°è¦é¡§å®¢å¯¾å¿œã®è‡ªå‹•åŒ–**: éŸ³å£°ã«ã‚ˆã‚‹æ¡ˆå†…ã¨Q&Aå¯¾å¿œ
- **å¤šè¨€èªã‚µãƒãƒ¼ãƒˆ**: æ—¥æœ¬èªãƒ»è‹±èªã§ã®å¯¾å¿œ
- **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**: éŸ³å£°åˆ¶å¾¡å¯èƒ½ãªã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ã‚¹ãƒ†ãƒ 
- **3Dã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¬ã‚¤ãƒ‰**: VRMã‚¢ãƒã‚¿ãƒ¼ã«ã‚ˆã‚‹è¦ªã—ã¿ã‚„ã™ã„æ¥å®¢
- **èƒŒæ™¯ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**: å‹•çš„ãªèƒŒæ™¯å¤‰æ›´ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ©Ÿèƒ½

### âœ¨ ä¸»è¦æ©Ÿèƒ½

| æ©Ÿèƒ½ã‚«ãƒ†ã‚´ãƒª          | æ©Ÿèƒ½è©³ç´°                       |
|-------------------|----------------------------|
| ğŸ¤ **éŸ³å£°å¯¾è©±**   | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°èªè­˜ãƒ»åˆæˆã€å‰²ã‚Šè¾¼ã¿å¯¾å¿œ |
| ğŸŒ **Web Speech API** | ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒ†ã‚£ãƒ–éŸ³å£°èªè­˜ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰|
| ğŸ­ **æ„Ÿæƒ…èªè­˜**   | ãƒ†ã‚­ã‚¹ãƒˆè§£æã«ã‚ˆã‚‹æ„Ÿæƒ…æ¤œå‡ºã€VRMè¡¨æƒ…åˆ¶å¾¡ |
| ğŸ˜Š **ãƒ†ã‚­ã‚¹ãƒˆæ„Ÿæƒ…èªè­˜**   | ä¼šè©±å†…å®¹ã‹ã‚‰ã®æ„Ÿæƒ…åˆ†æã¨VRMè¡¨æƒ…åˆ¶å¾¡ |
| ğŸ“Š **å‹•çš„ã‚¹ãƒ©ã‚¤ãƒ‰**   | Marp Markdownã€éŸ³å£°ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é€£å‹•   |
| ğŸ¤– **3Dã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼**   | VRMã‚¢ãƒã‚¿ãƒ¼ã€æ„Ÿæƒ…é€£å‹•è¡¨æƒ…ãƒ»å‹•ä½œåˆ¶å¾¡      |
| ğŸŒ **å¤šè¨€èªå¯¾å¿œ** | æ—¥æœ¬èªãƒ»è‹±èªåˆ‡ã‚Šæ›¿ãˆã€å¤šè¨€èªæ„Ÿæƒ…èªè­˜    |
| ğŸ” **RAG Q&A**    | çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å›ç­”           |
| ğŸ’¾ **ä¼šè©±è¨˜æ†¶**   | Supabaseæ°¸ç¶šåŒ–ã€æ–‡è„ˆä¿æŒæ©Ÿèƒ½        |
| ğŸ”— **å¤–éƒ¨é€£æº**   | WebSocketå—ä»˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ          |
| ğŸ¨ **èƒŒæ™¯åˆ¶å¾¡**   | å‹•çš„èƒŒæ™¯ç”»åƒå¤‰æ›´ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ     |
| ğŸ”’ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**  | XSSå¯¾ç­–ã€iframe ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–     |

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TB
    subgraph "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (Next.js 15)"
        UI[UI Components]
        Voice[Audio Interface]
        Slide[Marp Viewer]
        Char[3D Character]
    end
    
    subgraph "ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (Mastra + API Routes)"
        Agent[Mastra Agents]
        Tools[Mastra Tools]
        Memory[Agent Memory]
    end
    
    subgraph "å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹"
        GCP[Google Cloud<br/>Speech/TTS]
        Gemini[Gemini 2.5<br/>Flash Preview]
        DB[(PostgreSQL<br/>+ pgvector)]
    end
    
    UI --> Voice
    Voice --> Agent
    Slide --> Tools
    Char --> Tools
    Agent --> GCP
    Agent --> Gemini
    Memory --> DB
    Tools --> DB
```

### ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

#### ã‚³ã‚¢æŠ€è¡“
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: [Mastra 0.10.1](https://mastra.ai/) - AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–‹ç™ºãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Frontend**: [Next.js 15.3.2](https://nextjs.org/) + [TypeScript 5.8.3](https://www.typescriptlang.org/)
- **AI/ML**: [Google Gemini 2.5 Flash Preview](https://ai.google.dev/)
- **éŸ³å£°å‡¦ç†**: [Google Cloud Speech-to-Text/Text-to-Speech](https://cloud.google.com/speech-to-text)

#### å°‚é–€æŠ€è¡“
- **3Dã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼**: [Three.js 0.176.0](https://threejs.org/) + [@pixiv/three-vrm 3.4.0](https://github.com/pixiv/three-vrm)
- **ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ã‚¹ãƒ†ãƒ **: [Marp Core 4.1.0](https://marp.app/) (Markdown Presentation Ecosystem)
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: [PostgreSQL](https://www.postgresql.org/) + [Supabase 2.49.8](https://supabase.com/)
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: [Tailwind CSS v3.4.17](https://tailwindcss.com/) âš ï¸ **é‡è¦: v3ã‚’ä½¿ç”¨**

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»å“è³ª
- **HTMLã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**: ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ã«ã‚ˆã‚‹XSSå¯¾ç­–
- **iframe ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹**: `allow-scripts allow-same-origin allow-popups allow-forms`
- **Originæ¤œè¨¼**: postMessageé€šä¿¡ã§ã®ä¿¡é ¼ã§ãã‚‹ã‚ªãƒªã‚¸ãƒ³ãƒã‚§ãƒƒã‚¯
- **çŠ¶æ…‹ç®¡ç†**: React 19.1.0ã®æ–°æ©Ÿèƒ½æ´»ç”¨

## âš ï¸ é‡è¦: Tailwind CSS ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¤ã„ã¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **Tailwind CSS v3.4.17** ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚Tailwind CSS v4ã«ã¯ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãªã„ã§ãã ã•ã„ã€‚v4ã«ã¯ç ´å£Šçš„å¤‰æ›´ãŒã‚ã‚Šã€ç•°ãªã‚‹è¨­å®šè¦ä»¶ãŒã‚ã‚Šã¾ã™ã€‚

### CSS ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ä¾å­˜é–¢ä¿‚
- `tailwindcss@3.4.17` - CSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ (v3ã€v4ã§ã¯ã‚ã‚Šã¾ã›ã‚“)
- `postcss@8.4.47` - CSSãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼
- `autoprefixer@10.4.20` - ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹è¿½åŠ 

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
pnpm add -D tailwindcss@3.4.17 postcss@8.4.47 autoprefixer@10.4.20
```

### å¿…è¦ãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- `tailwind.config.js` - Tailwind v3è¨­å®š
- `postcss.config.js` - PostCSSè¨­å®š
- `src/app/globals.css` - Tailwindãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å«ã‚€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å‰ææ¡ä»¶

- **Node.js** 18.0.0 ä»¥ä¸Š
- **pnpm** 8.0.0 ä»¥ä¸Š ï¼ˆæ¨å¥¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰
- **PostgreSQL** 14 ä»¥ä¸Š + pgvectoræ‹¡å¼µ
- **Google Cloud Platform** ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆSpeech APIæœ‰åŠ¹åŒ–æ¸ˆã¿ï¼‰

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/your-org/engineer-cafe-navigator.git
cd engineer-cafe-navigator
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm install
```

### 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cp .env.example .env
```

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼š

```env
# ğŸ”‘ Google Cloud (Service Accountèªè¨¼)
GOOGLE_CLOUD_PROJECT_ID=your-gcp-project-id
GOOGLE_CLOUD_CREDENTIALS=./config/service-account-key.json
# APIã‚­ãƒ¼ã¯ä¸è¦ã«ãªã‚Šã¾ã—ãŸï¼ˆService Accountã§èªè¨¼ï¼‰

# ğŸ¤– Gemini AI
GOOGLE_GENERATIVE_AI_API_KEY=your-gemini-api-key
GEMINI_MODEL=gemini-2.5-flash-preview-05-20

# ğŸ—„ï¸ Database (Supabase)
POSTGRES_URL=postgresql://postgres:password@db.project.supabase.co:5432/postgres
NEXT_PUBLIC_SUPABASE_URL=https://project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# ğŸŒ Next.js
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-secret-key

# ğŸ”Œ External Integration
WEBSOCKET_URL=ws://localhost:8080
RECEPTION_API_URL=http://localhost:8080/api

# ğŸ›ï¸ Feature Toggles (è¨ˆç”»ä¸­)
# NEXT_PUBLIC_ENABLE_FACIAL_EXPRESSION=false
# NEXT_PUBLIC_USE_WEB_SPEECH_API=false
```

#### Service Account è¨­å®š

1. **Service Accountä½œæˆ**:
   ```bash
   # Google Cloud Console ã§ Service Account ã‚’ä½œæˆ
   # å¿…è¦ãªæ¨©é™: Cloud Speech-to-Text User, Cloud Text-to-Speech User
   ```

2. **ã‚­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®**:
   ```bash
   # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸJSONã‚­ãƒ¼ã‚’é…ç½®
   cp ~/Downloads/service-account-key.json ./config/service-account-key.json
   ```

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### Supabaseã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼ˆæ¨å¥¨ï¼‰

```bash
# Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§è‡ªå‹•çš„ã«PostgreSQL + pgvectorãŒåˆ©ç”¨å¯èƒ½
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ
pnpm supabase migration up
```

#### ãƒ­ãƒ¼ã‚«ãƒ«PostgreSQLã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ

```bash
# PostgreSQL + pgvectorã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« (macOS)
brew install postgresql pgvector

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
createdb engineer_cafe_navigator

# pgvectoræ‹¡å¼µã®æœ‰åŠ¹åŒ–
psql engineer_cafe_navigator -c "CREATE EXTENSION IF NOT EXISTS vector;"

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
psql engineer_cafe_navigator < supabase/migrations/20250529005253_init_engineer_cafe_navigator.sql
```

### 5. VRMã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®é…ç½®

VRMãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã«é…ç½®ï¼š

```
public/characters/models/
â””â”€â”€ sakura.vrm              # ãƒ¡ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
```

> ğŸ’¡ **VRMãƒ¢ãƒ‡ãƒ«ã®å…¥æ‰‹æ–¹æ³•**
> - [VRoid Hub](https://hub.vroid.com/) - ç„¡æ–™ãƒ¢ãƒ‡ãƒ«å¤šæ•°
> - [Booth](https://booth.pm/) - æœ‰æ–™ãƒ»é«˜å“è³ªãƒ¢ãƒ‡ãƒ«
> - [VRoid Studio](https://vroid.com/studio) - è‡ªä½œã‚‚å¯èƒ½

### 6. èƒŒæ™¯ç”»åƒã®é…ç½®ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ã‚«ã‚¹ã‚¿ãƒ èƒŒæ™¯ç”»åƒã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

```
public/backgrounds/
â”œâ”€â”€ IMG_5573.JPG           # ã‚«ã‚¹ã‚¿ãƒ èƒŒæ™¯ç”»åƒ
â”œâ”€â”€ office.png
â””â”€â”€ cafe-interior.jpg
```

> ğŸ’¡ èƒŒæ™¯ç”»åƒã¯å‹•çš„ã«æ¤œå‡ºã•ã‚Œã€è¨­å®šãƒ‘ãƒãƒ«ã§é¸æŠå¯èƒ½ã§ã™

### 7. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
pnpm run dev
```

http://localhost:3000 ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¾ã™ğŸ‰

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
engineer-cafe-navigator/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ api/                      # API Routes
â”‚   â”‚   â”‚   â”œâ”€â”€ voice/route.ts        # éŸ³å£°å‡¦ç†API
â”‚   â”‚   â”‚   â”œâ”€â”€ marp/route.ts         # ã‚¹ãƒ©ã‚¤ãƒ‰API
â”‚   â”‚   â”‚   â”œâ”€â”€ character/route.ts    # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼API
â”‚   â”‚   â”‚   â”œâ”€â”€ slides/route.ts       # ã‚¹ãƒ©ã‚¤ãƒ‰æ“ä½œAPI
â”‚   â”‚   â”‚   â”œâ”€â”€ external/route.ts     # å¤–éƒ¨APIé€£æº
â”‚   â”‚   â”‚   â””â”€â”€ qa/route.ts           # Q&A API
â”‚   â”‚   â”œâ”€â”€ components/               # React Components
â”‚   â”‚   â”‚   â”œâ”€â”€ AudioControls.tsx     # éŸ³å£°åˆ¶å¾¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ BackgroundSelector.tsx # èƒŒæ™¯é¸æŠã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterAvatar.tsx   # VRMã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ LanguageSelector.tsx  # è¨€èªåˆ‡ã‚Šæ›¿ãˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ MarpViewer.tsx        # Marpã‚¹ãƒ©ã‚¤ãƒ‰ãƒ“ãƒ¥ãƒ¼ã‚¢
â”‚   â”‚   â”‚   â”œâ”€â”€ SlideDebugPanel.tsx   # ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ‡ãƒãƒƒã‚°ãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ VoiceInterface.tsx    # éŸ³å£°ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ globals.css               # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”‚   â”‚   â””â”€â”€ page.tsx                  # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ mastra/                       # Mastraè¨­å®š
â”‚   â”‚   â”œâ”€â”€ agents/                   # AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ qa-agent.ts           # Q&Aã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ realtime-agent.ts     # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ slide-narrator.ts     # ã‚¹ãƒ©ã‚¤ãƒ‰ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ welcome-agent.ts      # ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ tools/                    # Mastra Tools
â”‚   â”‚   â”‚   â”œâ”€â”€ character-control.ts  # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åˆ¶å¾¡
â”‚   â”‚   â”‚   â”œâ”€â”€ external-api.ts       # å¤–éƒ¨APIé€£æº
â”‚   â”‚   â”‚   â”œâ”€â”€ language-switch.ts    # è¨€èªåˆ‡ã‚Šæ›¿ãˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ marp-renderer.ts      # Marpãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ narration-loader.ts   # ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³èª­ã¿è¾¼ã¿
â”‚   â”‚   â”‚   â”œâ”€â”€ page-transition.ts    # ãƒšãƒ¼ã‚¸é·ç§»
â”‚   â”‚   â”‚   â””â”€â”€ slide-control.ts      # ã‚¹ãƒ©ã‚¤ãƒ‰åˆ¶å¾¡
â”‚   â”‚   â”œâ”€â”€ voice/                    # éŸ³å£°ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚   â”‚   â””â”€â”€ google-cloud-voice.ts # Google CloudéŸ³å£°API
â”‚   â”‚   â”œâ”€â”€ types/                    # Mastraå‹å®šç¾©
â”‚   â”‚   â””â”€â”€ index.ts                  # Mastraè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ slides/                       # ã‚¹ãƒ©ã‚¤ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
â”‚   â”‚   â”œâ”€â”€ engineer-cafe.md          # ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â”œâ”€â”€ themes/                   # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ default.css           # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ¼ãƒ
â”‚   â”‚   â”‚   â””â”€â”€ engineer-cafe.css     # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ
â”‚   â”‚   â”œâ”€â”€ narration/                # ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³JSON
â”‚   â”‚   â”‚   â”œâ”€â”€ engineer-cafe-ja.json # æ—¥æœ¬èªãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â””â”€â”€ engineer-cafe-en.json # è‹±èªãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â””â”€â”€ assets/images/            # ã‚¹ãƒ©ã‚¤ãƒ‰ç”¨ç”»åƒ
â”‚   â”œâ”€â”€ characters/                   # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¢ã‚»ãƒƒãƒˆ
â”‚   â”‚   â”œâ”€â”€ animations/               # ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â””â”€â”€ greetings.json        # æŒ¨æ‹¶ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â””â”€â”€ expressions/              # è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ lib/                          # å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚   â”‚   â”œâ”€â”€ audio-player.ts           # éŸ³å£°å†ç”Ÿ
â”‚   â”‚   â”œâ”€â”€ marp-processor.ts         # Marpå‡¦ç†
â”‚   â”‚   â”œâ”€â”€ narration-manager.ts      # ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ supabase.ts              # Supabaseè¨­å®š
â”‚   â”‚   â”œâ”€â”€ supabase-memory.ts       # Supabaseãƒ¡ãƒ¢ãƒªç®¡ç†
â”‚   â”‚   â”œâ”€â”€ voice-recorder.ts         # éŸ³å£°éŒ²éŸ³
â”‚   â”‚   â”œâ”€â”€ vrm-utils.ts             # VRMãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â””â”€â”€ websocket-manager.ts      # WebSocketç®¡ç†
â”‚   â””â”€â”€ types/                        # å‹å®šç¾©
â”‚       â””â”€â”€ supabase.ts              # Supabaseå‹å®šç¾©
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ characters/models/            # VRMãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â””â”€â”€ sakura.vrm               # ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
â”‚   â””â”€â”€ backgrounds/                  # èƒŒæ™¯ç”»åƒ (å‹•çš„æ¤œå‡º)
â”œâ”€â”€ supabase/                         # Supabaseè¨­å®š
â”‚   â”œâ”€â”€ config.toml                   # Supabaseè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ migrations/                   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ config/                           # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ .env                              # ç’°å¢ƒå¤‰æ•°
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ postcss.config.js
â”œâ”€â”€ next.config.js
â””â”€â”€ tsconfig.json
```

## ğŸ¯ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰éŸ³å£°èªè­˜ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### æ¦‚è¦
Engineer Cafe Navigatorã¯Google Cloud STTã¨Web Speech APIã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ¡ç”¨ã—ã€ã‚³ã‚¹ãƒˆå‰Šæ¸›ã¨å“è³ªå‘ä¸Šã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

### éŸ³å£°èªè­˜ã®å®Ÿè£…
- **Google Cloud STTï¼ˆService Accountèªè¨¼ï¼‰**: é«˜ç²¾åº¦ãªéŸ³å£°èªè­˜ã‚’æä¾›ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- **MediaRecorder API**: WebM/Opuså½¢å¼ã§ã®é«˜å“è³ªéŸ³å£°éŒ²éŸ³ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰

### ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®æ„Ÿæƒ…èªè­˜ (å®Ÿè£…æ¸ˆã¿)
- **EmotionManager**: æ—¥æœ¬èªãƒ»è‹±èªã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æã«ã‚ˆã‚‹æ„Ÿæƒ…æ¤œå‡º
- **VRMè¡¨æƒ…åˆ¶å¾¡**: 6ç¨®é¡ã®æ„Ÿæƒ…è¡¨ç¾ï¼ˆneutral, happy, sad, angry, relaxed, surprisedï¼‰
- **ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé€£å‹•**: ä¼šè©±å±¥æ­´ã‚’è€ƒæ…®ã—ãŸæ„Ÿæƒ…åˆ¤å®š

### å°†æ¥ã®æ‹¡å¼µäºˆå®š
ä»¥ä¸‹ã®æ©Ÿèƒ½ã¯å°†æ¥ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å®Ÿè£…äºˆå®šã§ã™ï¼š

- **Web Speech API**: ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒ†ã‚£ãƒ–éŸ³å£°èªè­˜ï¼ˆç¾åœ¨ã¯Google Cloud STTã‚’ä½¿ç”¨ï¼‰
- **è¡¨æƒ…èªè­˜**: face-api.jsã‚’ä½¿ã£ãŸã‚«ãƒ¡ãƒ©ãƒ™ãƒ¼ã‚¹ã®è¡¨æƒ…æ¤œå‡º
- **Enhanced Voice API**: `/api/voice/enhanced`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§
- **Google Cloud STT**: ã™ã¹ã¦ã®ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã§å‹•ä½œ
- **MediaRecorder API**: Chrome, Firefox, Edgeã§å®Œå…¨å¯¾å¿œã€Safariã§éƒ¨åˆ†å¯¾å¿œ
- **Three.js VRM**: å…¨ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ

## ğŸ® ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬çš„ãªæ“ä½œãƒ•ãƒ­ãƒ¼

1. **è¨€èªé¸æŠ**: åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«æ—¥æœ¬èª/è‹±èªã‚’é¸æŠ
2. **éŸ³å£°å¯¾è©±é–‹å§‹**: ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©±ã—ã‹ã‘
3. **ã‚¹ãƒ©ã‚¤ãƒ‰æ¡ˆå†…**: AIãŒè‡ªå‹•ã§ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’é€²è¡Œãƒ»èª¬æ˜
4. **è³ªå•å¯¾å¿œ**: ã€Œè³ªå•ãŒã‚ã‚Šã¾ã™ã€ã¨è¨€ã£ã¦Q&Aãƒ¢ãƒ¼ãƒ‰ã«ç§»è¡Œ
5. **ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é€£å‹•**: éŸ³å£°ã«åˆã‚ã›ã¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒåå¿œ

### éŸ³å£°ã‚³ãƒãƒ³ãƒ‰ä¾‹

| æ—¥æœ¬èª         | English                 | å‹•ä½œ          |
|---------------|-------------------------|--------------|
| "æ¬¡ã®ã‚¹ãƒ©ã‚¤ãƒ‰"      | "Next slide"            | ã‚¹ãƒ©ã‚¤ãƒ‰é€²è¡Œ      |
| "å‰ã«æˆ»ã£ã¦"      | "Go back"               | ã‚¹ãƒ©ã‚¤ãƒ‰æˆ»ã‚‹       |
| "æœ€åˆã‹ã‚‰"       | "Start over"            | æœ€åˆã®ã‚¹ãƒ©ã‚¤ãƒ‰ã¸    |
| "è³ªå•ãŒã‚ã‚Šã¾ã™"    | "I have a question"     | Q&Aãƒ¢ãƒ¼ãƒ‰ã¸åˆ‡ã‚Šæ›¿ãˆ |
| "æ–™é‡‘ã«ã¤ã„ã¦è©³ã—ã" | "Tell me about pricing" | è©³ç´°æƒ…å ±æä¾›  |

## ğŸ”Œ APIä»•æ§˜

### éŸ³å£°å‡¦ç† API

#### POST /api/voice

éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ã¨AIå¿œç­”ã®ç”Ÿæˆ

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "action": "process_voice",
  "audioData": "base64-encoded-audio",
  "sessionId": "session_xxx"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "transcript": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™ºè¨€ãƒ†ã‚­ã‚¹ãƒˆ",
  "response": "AIã®å¿œç­”ãƒ†ã‚­ã‚¹ãƒˆ",
  "audioResponse": "base64-encoded-audio",
  "shouldUpdateCharacter": true,
  "characterAction": "greeting"
}
```

### ã‚¹ãƒ©ã‚¤ãƒ‰åˆ¶å¾¡ API

#### POST /api/marp

Marpã‚¹ãƒ©ã‚¤ãƒ‰ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨è¡¨ç¤º

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "action": "render_with_narration",
  "slideFile": "engineer-cafe",
  "theme": "engineer-cafe"
}
```

#### POST /api/slides

ã‚¹ãƒ©ã‚¤ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¨éŸ³å£°æ¡ˆå†…

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "action": "next",
  "slideFile": "engineer-cafe",
  "language": "ja"
}
```

### ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åˆ¶å¾¡ API

#### POST /api/character

3Dã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®è¡¨æƒ…ãƒ»å‹•ä½œåˆ¶å¾¡

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "action": "setExpression",
  "expression": "friendly",
  "transition": true
}
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ç›®æ¨™

| å‡¦ç†             | ç›®æ¨™æ™‚é–“    | å®Ÿè£…çŠ¶æ³           |
|----------------|-------------|--------------------|
| éŸ³å£°èªè­˜é–‹å§‹     | < 200ms     | âœ… Google Cloud STT |
| AIå¿œç­”ç”Ÿæˆ       | < 800ms     | âœ… Gemini 2.5 Flash |
| éŸ³å£°åˆæˆ         | < 300ms     | âœ… Google Cloud TTS |
| **ç·åˆå¿œç­”æ™‚é–“** | **< 1.3ç§’** | ğŸ”„ æœ€é©åŒ–ä¸­        |

### åŒæ™‚åˆ©ç”¨è€…æ•°

- **æƒ³å®š**: æœ€å¤§10å
- **ãƒ”ãƒ¼ã‚¯å¯¾å¿œ**: 20å
- **å®Ÿè£…**: Mastraã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸¦åˆ—å‡¦ç†

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»é‹ç”¨

### Vercelã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# Vercel CLIã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm install -g vercel

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–
vercel

# æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
vercel --prod
```

### ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆæœ¬ç•ªï¼‰

Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ä»¥ä¸‹ã‚’è¨­å®šï¼š

```bash
GOOGLE_CLOUD_PROJECT_ID=prod-project-id
GOOGLE_CLOUD_CREDENTIALS=./config/service-account-key.json
GOOGLE_GENERATIVE_AI_API_KEY=prod-gemini-key
NEXT_PUBLIC_SUPABASE_URL=https://project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
NEXTAUTH_SECRET=secure-production-secret
```

### æ¨å¥¨æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

- **[Neon](https://neon.tech/)**: Serverless PostgreSQL
- **[Supabase](https://supabase.com/)**: OSS Firebaseä»£æ›¿
- **[Railway](https://railway.app/)**: ç°¡å˜ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°

> ğŸ’¡ ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã§pgvectoræ‹¡å¼µãŒåˆ©ç”¨å¯èƒ½

## ğŸ” ç›£è¦–ãƒ»ãƒ­ã‚°

### Mastra Observability

```typescript
const mastra = new Mastra({
  observability: {
    enabled: true,
    trace: true,        // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒˆãƒ¬ãƒ¼ã‚¹
    metrics: true,      // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬
    logLevel: 'info',   // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
  },
});
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

- **Vercel Analytics**: ã‚¢ã‚¯ã‚»ã‚¹è§£æ
- **Mastra Metrics**: AIå¿œç­”æ™‚é–“
- **Custom Logging**: éŸ³å£°å‡¦ç†ãƒ­ã‚°

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### ğŸ¤ éŸ³å£°èªè­˜ãŒå‹•ä½œã—ãªã„

**ç—‡çŠ¶**: ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚åå¿œã—ãªã„

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®ç¢ºèª
# ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®š > ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ > ãƒã‚¤ã‚¯

# 2. HTTPSã®ç¢ºèªï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
# localhostã¯ä¾‹å¤–ãªã®ã§HTTPã§ã‚‚å‹•ä½œ

# 3. Service Accountæ¨©é™ã®ç¢ºèª
gcloud projects get-iam-policy $GOOGLE_CLOUD_PROJECT_ID \
  --flatten="bindings[].members" \
  --filter="bindings.members:serviceAccount:*"

# 4. Google Cloud APIã®æœ‰åŠ¹åŒ–ç¢ºèª
gcloud services list --enabled --filter="name:(speech|texttospeech)"
```

#### ğŸ” Service Accountèªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: "Could not refresh access token" ã‚¨ãƒ©ãƒ¼

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. Service Accountã‚­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
ls -la config/service-account-key.json

# 2. å¿…è¦ãªæ¨©é™ã®ä»˜ä¸
gcloud projects add-iam-policy-binding $GOOGLE_CLOUD_PROJECT_ID \
  --member="serviceAccount:YOUR_SERVICE_ACCOUNT_EMAIL" \
  --role="roles/speech.client"

# 3. APIã®æœ‰åŠ¹åŒ–
gcloud services enable speech.googleapis.com texttospeech.googleapis.com

# 4. ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
cat .env | grep GOOGLE_CLOUD
```

#### ğŸ¤– ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„

**ç—‡çŠ¶**: 3Dã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¨ãƒªã‚¢ãŒç©ºç™½

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. VRMãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®ç¢ºèª
ls src/characters/models/

# 2. ãƒ–ãƒ©ã‚¦ã‚¶ã®WebGLå¯¾å¿œç¢ºèª
# about:config ã§ webgl.disabled ã‚’ç¢ºèª

# 3. ãƒ¡ãƒ¢ãƒªä¸è¶³ã®ç¢ºèª
# é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ« > Performance ã‚¿ãƒ–ã§ç¢ºèª
```

#### ğŸ“Š ã‚¹ãƒ©ã‚¤ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œãªã„

**ç—‡çŠ¶**: ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¨ãƒªã‚¢ãŒã‚¨ãƒ©ãƒ¼è¡¨ç¤º

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ç¢ºèª
# Marpãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ç¢ºèªã¯æ‰‹å‹•ã§è¡Œã£ã¦ãã ã•ã„

# 2. ã‚¢ã‚»ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
ls src/slides/assets/images/

# 3. ãƒ†ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
ls src/slides/themes/
```

### ãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒãƒ³ãƒ‰

```bash
# å…¨ä½“çš„ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl http://localhost:3000/api/voice?action=status
curl http://localhost:3000/api/character?action=health
curl http://localhost:3000/api/marp?action=health

# ãƒ­ã‚°ã®ç¢ºèª
# ç¾åœ¨åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰
pnpm run dev         # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
pnpm run build       # ãƒ“ãƒ«ãƒ‰
pnpm run lint        # ESLintãƒã‚§ãƒƒã‚¯
pnpm run test:api    # APIãƒ†ã‚¹ãƒˆ
pnpm run test:rag    # RAGæ¤œç´¢ãƒ†ã‚¹ãƒˆ
pnpm run test:external-apis # å¤–éƒ¨APIãƒ†ã‚¹ãƒˆ
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

- **éŸ³å£°ãƒ‡ãƒ¼ã‚¿**: å‡¦ç†å¾Œå³åº§ã«å‰Šé™¤
- **ä¼šè©±ãƒ­ã‚°**: æš—å·åŒ–ä¿å­˜ï¼ˆMastra Memoryï¼‰
- **å€‹äººæƒ…å ±**: GDPRãƒ»å€‹äººæƒ…å ±ä¿è­·æ³•æº–æ‹ 

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

#### XSS (Cross-Site Scripting) å¯¾ç­–
```typescript
// HTMLã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
const sanitizeHtml = (html: string): string => {
  const parser = new DOMParser();
  const doc = parser.parseFromString(html, 'text/html');
  
  // ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã®é™¤å»
  const scripts = doc.querySelectorAll('script');
  scripts.forEach(script => script.remove());
  
  // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®é™¤å»
  const allElements = doc.querySelectorAll('*');
  allElements.forEach(element => {
    Array.from(element.attributes).forEach(attr => {
      if (attr.name.startsWith('on')) {
        element.removeAttribute(attr.name);
      }
    });
  });
  
  return doc.documentElement.outerHTML;
};
```

#### iframe ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–
```html
<iframe
  srcDoc={sanitizedHtml}
  sandbox="allow-scripts allow-same-origin allow-popups allow-forms"
  title="Slide presentation"
>
```

#### postMessage Originæ¤œè¨¼
```typescript
const handleMessage = (event: MessageEvent) => {
  const allowedOrigins = [
    window.location.origin,
    'null', // iframe srcDocã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”¨
  ];
  
  if (!allowedOrigins.includes(event.origin)) {
    console.warn('ä¿¡é ¼ã§ããªã„ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ‹’å¦:', event.origin);
    return;
  }
  
  // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†...
};
```

### API ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

```typescript
// å…¥åŠ›å€¤æ¤œè¨¼
const schema = z.object({
  audioData: z.string().max(10000000), // 10MBåˆ¶é™
  sessionId: z.string().uuid(),
});

// ãƒ¬ãƒ¼ãƒˆåˆ¶é™
const ratelimit = new Ratelimit({
  redis: Redis.fromEnv(),
  limiter: Ratelimit.slidingWindow(10, "10 s"),
});
```

## ğŸ“Š KPIãƒ»æˆåŠŸæŒ‡æ¨™

### åˆ©ç”¨æŒ‡æ¨™

- âœ… **æœˆé–“ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°**: ç›®æ¨™100ã‚»ãƒƒã‚·ãƒ§ãƒ³
- âœ… **å¹³å‡ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“**: 3-5åˆ†
- âœ… **å®Œäº†ç‡**: 80%ä»¥ä¸Š

### å“è³ªæŒ‡æ¨™

- âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦**: 4.0/5.0ä»¥ä¸Š
- âœ… **éŸ³å£°èªè­˜ç²¾åº¦**: 95%ä»¥ä¸Š
- âœ… **ã‚·ã‚¹ãƒ†ãƒ éšœå®³æ™‚é–“**: æœˆé–“1æ™‚é–“ä»¥å†…

### ãƒ“ã‚¸ãƒã‚¹æŒ‡æ¨™

- âœ… **ã‚¹ã‚¿ãƒƒãƒ•è² è·å‰Šæ¸›**: 50%
- âœ… **æ–°è¦ç™»éŒ²å®Œäº†ç‡**: +10%å‘ä¸Š
- âœ… **å¤šè¨€èªå¯¾å¿œåŠ¹ç‡**: 80%çŸ­ç¸®

## ğŸ—ºï¸ ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### ğŸ“… Phase 1 (å®Œäº†): MVPå®Ÿè£…
- [x] åŸºæœ¬éŸ³å£°å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ 
- [x] ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
- [x] 3Dã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼çµ±åˆ
- [x] å¤šè¨€èªå¯¾å¿œï¼ˆæ—¥è‹±ï¼‰

### ğŸ“… Phase 2 (è¨ˆç”»ä¸­): é«˜åº¦ãªå¯¾è©±
- [ ] ä¼šè©±ã®æ–‡è„ˆç†è§£å‘ä¸Š
- [ ] æ„Ÿæƒ…èªè­˜ãƒ»è¡¨ç¾
- [ ] ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
- [ ] ã•ã‚‰ãªã‚‹è¨€èªå¯¾å¿œ

### ğŸ“… Phase 3 (å°†æ¥): æ‹¡å¼µæ©Ÿèƒ½
- [ ] äºˆç´„ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- [ ] QRã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Š
- [ ] AR/VRä½“é¨“
- [ ] ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª

### ğŸ“… Phase 4 (ç™ºå±•): AIå¼·åŒ–
- [ ] å€‹äººåŒ–å¯¾å¿œ
- [ ] å­¦ç¿’å‹å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ 
- [ ] äºˆæ¸¬å‹æ¡ˆå†…
- [ ] ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«å…¥åŠ›

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

### é–‹ç™ºå‚åŠ æ–¹æ³•

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

```bash
# ESLint + Prettierå®Ÿè¡Œ
pnpm run lint
pnpm run format

# åˆ©ç”¨å¯èƒ½ãªãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰:
pnpm run test:api           # APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
pnpm run test:rag           # RAGæ¤œç´¢æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
pnpm run test:external-apis # å¤–éƒ¨APIé€£æºãƒ†ã‚¹ãƒˆ
```

### å•é¡Œå ±å‘Š

ãƒã‚°ã‚„æ”¹å–„ææ¡ˆã¯ [Issues](https://github.com/your-org/engineer-cafe-navigator/issues) ã«ã¦å ±å‘Šã—ã¦ãã ã•ã„ã€‚

## ğŸ“œ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT License](LICENSE) ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“ é€£çµ¡å…ˆãƒ»ã‚µãƒãƒ¼ãƒˆ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ãƒ 

- **é–‹ç™ºãƒªãƒ¼ãƒ€ãƒ¼**: [Your Name](mailto:your.email@example.com)
- **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚«ãƒ•ã‚§**: [cafe@example.com](mailto:cafe@example.com)

### æŠ€è¡“ã‚µãƒãƒ¼ãƒˆ

- **Issues**: [GitHub Issues](https://github.com/your-org/engineer-cafe-navigator/issues)
- **Discussion**: [GitHub Discussions](https://github.com/your-org/engineer-cafe-navigator/discussions)
- **Discord**: [é–‹ç™ºã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£](https://discord.gg/your-invite)

## ğŸ“– è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **[ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§](docs/README.md)** - å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- **[ğŸ“– APIä»•æ§˜æ›¸](docs/API.md)** - REST APIå®Œå…¨ä»•æ§˜
- **[ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰](docs/SECURITY.md)** - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ãƒ»è„…å¨åˆ†æ
- **[ğŸ› ï¸ é–‹ç™ºã‚¬ã‚¤ãƒ‰](docs/DEVELOPMENT.md)** - é–‹ç™ºè€…å‘ã‘æŠ€è¡“ä»•æ§˜
- **[ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰](docs/DEPLOYMENT.md)** - æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- âœ… **XSSå¯¾ç­–**: HTMLã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…æ¸ˆã¿
- âœ… **iframeä¿è­·**: ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ– + Originæ¤œè¨¼
- âœ… **é€šä¿¡æš—å·åŒ–**: HTTPS + ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
- âœ… **å…¥åŠ›æ¤œè¨¼**: Zodã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… **ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼**: UIçŠ¶æ…‹åŒæœŸã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ä¿è­·

---

<div align="center">

**Built with â¤ï¸ by Engineer Cafe Team**

[ğŸ  ãƒ›ãƒ¼ãƒ ](https://engineer-cafe.fukuoka.jp) â€¢ [ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](docs/README.md) â€¢ [ğŸš€ ãƒ‡ãƒ¢](https://demo.engineer-cafe-navigator.vercel.app)

</div>
